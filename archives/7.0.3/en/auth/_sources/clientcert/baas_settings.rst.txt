.. _client_cert_server_settings:

================
BaaSサーバ設定
================

本章では、クライアント証明書認証で必要なBaaSサーバ側の設定を説明します。

関連する設定は、デベロッパーコンソールから行います。

システム設定 - クライアント証明書認証設定
==========================================

システム設定 から **クライアント証明書認証設定** を編集します。
クライアント証明書認証を使用する場合に、サーバキーの値がHAProxyの設定するヘッダ *X-SSL-Validate-Token* と
一致しない場合はリクエストを拒否します。

意図せず `システム構成 <./intro.html>`_  に反した状態となった場合に、セキュリティを確保するために使用します。
偶然の一致を避けるため、UUIDのようなランダム文字列を使用することを推奨します。

詳細は `システム設定 <../../devconsole/system/system_config.html>`_ を参照してください。


.. note::
   本設定はHAProxyを使用する場合のみ有効です。
   Tomcatによる認証使用時は参照しません。

.. warning::
    サーバキーのみでは十分なセキュリティは確保できません。
    システム構築・更新時、ネットワーク構成に問題が無いか検討下さい。

テナント設定 - クライアント証明書認証
=======================================

クライアント証明書認証の適用可否は、テナント毎に設定することができます。
テナント設定の **クライアント証明書認証** を選択します。

クライアント証明書認証の適用可否や、ユーザ名に使用する要素の選択などが可能です。

詳細は `テナント設定 - クライアント証明書認証 <../../devconsole/tenant/tenant_config_client_cert.html>`_ を参照してください。

クライアント証明書ユーザ登録
==============================

前述のテナント設定で、ユーザ自動登録(プロビジョニング)の可否を選択することができます。
プロビジョニングを無効にする場合、クライアント証明書認証専用のユーザ登録を事前に登録してから使用します。

システムのユーザ作成のポリシーに合った方式を選択して下さい。

ユーザの事前登録の詳細は `ユーザ管理 <../../devconsole/tenant/user.html>`_ を参照してください。

.. note::
    クライアント証明書認証専用のユーザは、E-mail/passwordによる認証はできません。
