ADFS (Windows Server 2016)
============================

Windows Server 2016上での操作を例に説明します。

ADFSのインストール・起動はすでに完了しているものとします。

.. attention::

   ADFS のホストは、半角英数字、ハイフン、ピリオドで構成されるようにしてください。アンダースコアを使用しないでください。

アプリケーショングループの追加
--------------------------------

1) サーバーマネージャ＞ダッシュボード＞ツール＞AD FSの管理 を選択
2) ADFS 画面左の ADFS＞アプリケーショングループ を選択、右の操作パネルから「アプリケーショングループの追加」を選択
3) アプリケーショングループの追加ウィザードを開始
4) 名前を適当に入力、「スタンドアロン アプリケーション」の「サーバー アプリケーション」を選択し、「次へ」を選択
    **ここで表示された「クライアント識別子」はコピーしておく**
5) リダイレクト URI に以下を入力し、「追加」を選択
    {endpointUri}/1/{tenantId}/auth/oidc/auth_resp
        ※ {endpointUri} は デベロッパーコンソールのシステム設定で、APIサーバベース URI に設定した URI
6) 「共有シークレットを生成する」にチェックを入れる
    **ここで表示された「シークレット」はコピーしておく**
7) 設定内容を確認し、[次へ]を選択

4.と6. でコピーした値は以下で使用します。

* クライアント識別子: デベロッパーコンソール画面に設定する Client ID となります。
* シークレット: デベロッパーコンソール画面に設定する Client Secret となります。

詳細は、`テナント設定 - OpenID Connect設定 <../../devconsole/tenant/tenant_config_oidc.html>`_ を参照してください。

.. attention::

   ADFS (Windows Server 2012 R2) は、OpenID Connect に対応しておりませんので、OP として使用できません。
   認証連携する場合は、LDAP や SAML を使用してください。
   詳細は `モバイルバックエンド基盤 認証機能ガイド <../../auth/index.html>`_ を参照してください。

.. attention::

   テスト環境において、ADFSに自己署名証明書を使用する場合は、BaaS サーバ側のJavaキーストアに証明書をインポートしてください。
   なお、本番環境では正規の証明書を使用するようにしてください。
