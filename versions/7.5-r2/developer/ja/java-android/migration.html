

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="ja" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="ja" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>13. マイグレーションガイド &mdash; Java/Android SDK Guide 7.5.0 ドキュメント</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
    <link rel="index" title="索引" href="genindex.html" />
    <link rel="search" title="検索" href="search.html" />
    <link rel="next" title="14. 制限事項" href="restrictions.html" />
    <link rel="prev" title="12. API Gateway" href="api_gateway.html" /> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> Java/Android SDK Guide
          

          
          </a>

          
            
            
              <div class="version">
                7.5.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="intro.html">1. はじめに</a></li>
<li class="toctree-l1"><a class="reference internal" href="setup.html">2. SDKセットアップ手順</a></li>
<li class="toctree-l1"><a class="reference internal" href="initialize.html">3. 初期化処理の実装</a></li>
<li class="toctree-l1"><a class="reference internal" href="basics.html">4. NEC BaaS Java API の基本</a></li>
<li class="toctree-l1"><a class="reference internal" href="user.html">5. ユーザ管理</a></li>
<li class="toctree-l1"><a class="reference internal" href="group.html">6. グループ管理</a></li>
<li class="toctree-l1"><a class="reference internal" href="object_storage.html">7. JSONオブジェクトストレージ</a></li>
<li class="toctree-l1"><a class="reference internal" href="object_query.html">8. オブジェクトストレージ:クエリ</a></li>
<li class="toctree-l1"><a class="reference internal" href="object_aggregation.html">9. オブジェクトの集計</a></li>
<li class="toctree-l1"><a class="reference internal" href="file_storage.html">10. ファイルストレージ</a></li>
<li class="toctree-l1"><a class="reference internal" href="object_offline.html">11. オフライン機能</a></li>
<li class="toctree-l1"><a class="reference internal" href="api_gateway.html">12. API Gateway</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">13. マイグレーションガイド</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#ver-7-0-0-7-5-0">13.1. ver 7.0.0 → 7.5.0 での変更点</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#api">13.1.1. API 追加</a></li>
<li class="toctree-l3"><a class="reference internal" href="#http-2">13.1.2. HTTP/2対応</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#ver-6-5-0-7-0-0">13.2. ver 6.5.0 → 7.0.0 での変更点</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id2">13.2.1. ライブラリ構成変更</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id3">13.2.2. API 追加</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#ver-6-0-0-6-5-0">13.3. ver 6.0.0 → 6.5.0 での変更点</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id4">13.3.1. 依存ライブラリの変更</a></li>
<li class="toctree-l3"><a class="reference internal" href="#nbservicebuilder-setproxy">13.3.2. NbServiceBuilder.setProxy() 削除</a></li>
<li class="toctree-l3"><a class="reference internal" href="#nbuser-login">13.3.3. NbUser.login メソッド変更</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id5">13.3.4. コールバック型変更</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id6">13.3.5. コールバックで複数値を受け取る API を単数値受け取りに変更</a></li>
<li class="toctree-l3"><a class="reference internal" href="#nbobject-query-nbuser-query">13.3.6. NbObject.query および NbUser.query メソッド変更</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id7">13.3.7. クライアント証明書認証</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#ver-5-0-1-6-0-0">13.4. ver 5.0.1 → 6.0.0 での変更点</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#push">13.4.1. Push</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#ver-5-0-0-5-0-1">13.5. ver 5.0.0 → 5.0.1 での変更点</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#sse-push">13.5.1. SSE Push</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#ver-4-0-0-5-0-0">13.6. ver 4.0.0 → 5.0.0 での変更点</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id11">13.6.1. ユーザ管理</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#ver-3-0-0-4-0-0">13.7. ver 3.0.0 → 4.0.0 での変更点</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#sqlcipher">13.7.1. SQLCipher</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id12">13.7.2. 依存ライブラリの更新</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id13">13.7.3. SSE Push 機能追加</a></li>
<li class="toctree-l3"><a class="reference internal" href="#sde-push">13.7.4. SDE Push 機能削除</a></li>
<li class="toctree-l3"><a class="reference internal" href="#adt-plugin">13.7.5. ADT Plugin サポート削除</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#ver-1-2-3-3-0-0">13.8. ver 1.2.3 →3.0.0 での変更点</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id15">13.8.1. バッチAPIの追加</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id16">13.8.2. ユーザオプションフィールドの追加</a></li>
<li class="toctree-l3"><a class="reference internal" href="#sslv3">13.8.3. SSLv3 無効化</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#ver-1-2-2-1-2-3">13.9. ver 1.2.2 → 1.2.3 での変更点</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id17">13.9.1. オフライン機能の改善</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id18">13.9.2. API強化</a></li>
<li class="toctree-l3"><a class="reference internal" href="#pure-java">13.9.3. マルチテナント対応 (Pure Java のみ)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#ver-1-2-1-1-2-2">13.10. ver 1.2.1 → 1.2.2 での変更点</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id19">13.10.1. オフライン機能の改善</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id20">13.10.2. オフラインバケットインデックス機能の追加</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id21">13.10.3. インデックス・シャードキー関連</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id22">13.10.4. ファイルオフライン機能</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#ver-1-2-0-1-2-1">13.11. ver 1.2.0 → 1.2.1 での変更点</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#jar">13.11.1. ライブラリJARの変更</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id23">13.11.2. ユーザ/グループAPIの変更</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#ver-1-1-0-1-2-0-api">13.12. ver 1.1.0 → 1.2.0 での API 変更点</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id24">13.12.1. パッケージの変更</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id25">13.12.2. クラス名の変更</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id26">13.12.3. 定数名変更</a></li>
<li class="toctree-l3"><a class="reference internal" href="#int-enum">13.12.4. 型変更 (int → enum)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id27">13.12.5. その他</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#ver-1-0-0-1-1-0-api">13.13. ver 1.0.0 → 1.1.0 での API 変更点</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#push-api">13.13.1. Push 関連 API の追加</a></li>
<li class="toctree-l3"><a class="reference internal" href="#onfailure">13.13.2. onFailure メソッド引数変更</a></li>
<li class="toctree-l3"><a class="reference internal" href="#networkmode-cachepolicy-syncstate">13.13.3. NetworkMode, CachePolicy, SyncState 型の導入</a></li>
<li class="toctree-l3"><a class="reference internal" href="#android">13.13.4. コールバックスレッドの動作変更(Android実装のみ)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="restrictions.html">14. 制限事項</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Java/Android SDK Guide</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>13. マイグレーションガイド</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="id1">
<h1>13. マイグレーションガイド<a class="headerlink" href="#id1" title="このヘッドラインへのパーマリンク">¶</a></h1>
<p>本章では、NEC BaaS Java / Android SDK の以前のバージョンからの
API の変更点や移行方法について説明します。</p>
<div class="section" id="ver-7-0-0-7-5-0">
<h2>13.1. ver 7.0.0 → 7.5.0 での変更点<a class="headerlink" href="#ver-7-0-0-7-5-0" title="このヘッドラインへのパーマリンク">¶</a></h2>
<div class="section" id="api">
<h3>13.1.1. API 追加<a class="headerlink" href="#api" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>以下の API が追加されました。</p>
<ul class="simple">
<li>JSONオブジェクトストレージ:クエリ プロジェクション</li>
</ul>
<p>詳細は <a class="reference internal" href="object_query.html#query-ptrojection"><span class="std std-ref">プロジェクション</span></a> を参照してください。</p>
</div>
<div class="section" id="http-2">
<h3>13.1.2. HTTP/2対応<a class="headerlink" href="#http-2" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>HTTP/2プロトコルに対応しました。</p>
<p>詳細は <a class="reference internal" href="initialize.html#initialize-http2"><span class="std std-ref">HTTP/2対応</span></a> を参照して下さい。</p>
</div>
</div>
<div class="section" id="ver-6-5-0-7-0-0">
<h2>13.2. ver 6.5.0 → 7.0.0 での変更点<a class="headerlink" href="#ver-6-5-0-7-0-0" title="このヘッドラインへのパーマリンク">¶</a></h2>
<div class="section" id="id2">
<h3>13.2.1. ライブラリ構成変更<a class="headerlink" href="#id2" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>SDKライブラリのファイル名(.jar, .aar)および構成が一部変更となりました。</p>
<ul class="simple">
<li>NebulaClientCore-*.jar ⇒ baas-client-core-*.jar</li>
<li>NebulaClientAndroid-*.jar ⇒ baas-client-android-*.jar</li>
<li>SsePushClient-*.jar ⇒ ssepush-client-*.jar</li>
<li>sde_commons-cipherdb-*.aar ⇒ 削除 (baas-client-android-*.jar に包含)</li>
</ul>
<p>また、Android の場合は baas-client-core-*.jar の組み込みも合わせて必要となります。</p>
<p>詳細は <a class="reference internal" href="setup.html#sdk-setup"><span class="std std-ref">SDKセットアップ手順</span></a> を参照してください。</p>
</div>
<div class="section" id="id3">
<h3>13.2.2. API 追加<a class="headerlink" href="#id3" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>以下の API が追加されました。</p>
<ul class="simple">
<li>JSONオブジェクトストレージ: Aggregation</li>
<li>API Gateway 呼び出し</li>
</ul>
<p>詳細は、 <a class="reference internal" href="object_aggregation.html"><span class="doc">オブジェクトの集計</span></a> 、<a class="reference internal" href="api_gateway.html"><span class="doc">API Gateway</span></a> を参照して下さい。</p>
</div>
</div>
<div class="section" id="ver-6-0-0-6-5-0">
<h2>13.3. ver 6.0.0 → 6.5.0 での変更点<a class="headerlink" href="#ver-6-0-0-6-5-0" title="このヘッドラインへのパーマリンク">¶</a></h2>
<div class="section" id="id4">
<h3>13.3.1. 依存ライブラリの変更<a class="headerlink" href="#id4" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>依存ライブラリから httpclient が削除となり、代わりに okhttp が必要になりました。
詳細は <a class="reference internal" href="setup.html#sdk-setup"><span class="std std-ref">SDKセットアップ手順</span></a> を参照してください。</p>
</div>
<div class="section" id="nbservicebuilder-setproxy">
<h3>13.3.2. NbServiceBuilder.setProxy() 削除<a class="headerlink" href="#nbservicebuilder-setproxy" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>NbServiceBuilder.setProxy() は削除となりました。
今後は NbService.setProxy() を使用してください。なお、プロキシ設定は
全 NbService で１つのみの共通指定となります。</p>
</div>
<div class="section" id="nbuser-login">
<h3>13.3.3. NbUser.login メソッド変更<a class="headerlink" href="#nbuser-login" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>NbUser.login の引数が変更となり、ワンタイムトークンを使用したログイン(SAMLなどで使用)
が可能となりました。
従来のメソッドもそのまま利用できますが、&#64;Deprecated 扱いとなります。</p>
<p>また、ユーザ名でログインする loginWithUsername() および
E-mail でログインする loginWithEmail() を新設しました。</p>
</div>
<div class="section" id="id5">
<h3>13.3.4. コールバック型変更<a class="headerlink" href="#id5" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>従来は API の結果を受け取るために、用途別に異なるコールバックインタフェース
(NbUsersCallback, NbObjectCallback など)を使用していましたが、
コールバックインタフェースを以下の３つに統一しました。</p>
<ul class="simple">
<li>NbResultCallback : onSuccess() の引数無し</li>
<li>NbCallback&lt;T&gt; : onSuccess() の引数は T 型の１個</li>
<li>NbCountCallback&lt;T&gt; : onSuccess() の引数は T 型、int 型(カウント)の２個</li>
</ul>
<p>従来のコールバックインタフェースは原則上記いずれかを継承する形となります。
(後方互換性は維持されます)</p>
</div>
<div class="section" id="id6">
<h3>13.3.5. コールバックで複数値を受け取る API を単数値受け取りに変更<a class="headerlink" href="#id6" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>以下の API について、コールバック型が変更となります。</p>
<ul class="simple">
<li>NbUser: login, logout, save, register, getUser, refreshCurrentUser</li>
<li>NbGroup: save, getGroup</li>
<li>NbObject: save, partUpdateObject</li>
<li>NbObjectBucket: getObject</li>
<li>NbFileBucket: uploadNewFile, uploadUpdateFile, getFileMetadata, enablePublishFile, disablePublishFile</li>
</ul>
<p>従来はこれらは List 型で値を受け取るようになっていましたが、
値は常に1個しか渡されないようになっていたため、
単一の値を受け取るようにコールバック型を変更しました。
(旧 API は &#64;Deprecated 扱いとなります)</p>
</div>
<div class="section" id="nbobject-query-nbuser-query">
<h3>13.3.6. NbObject.query および NbUser.query メソッド変更<a class="headerlink" href="#nbobject-query-nbuser-query" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>NbObject および NbUser の query() メソッドは、
query() と queryWithCount() の２つのメソッドに分割されました。</p>
<p>query() は全件数取得なし(コールバック型は NbCallback&lt;List&lt;T&gt;&gt; または NbListCallback&lt;T&gt;)、
queryWithCount() は全件数取得あり(コールバック型は NbCountCallback&lt;List&lt;T&gt;&gt;)
となります。
(旧 API は &#64;Deprecated 扱いとなります)</p>
<p>コードの変更例(NbObject.query())を以下に示します。</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="c1">// 旧実装</span>
<span class="n">bucket</span><span class="o">.</span><span class="na">query</span><span class="o">(</span><span class="n">query</span><span class="o">,</span> <span class="k">new</span> <span class="n">NbObjectCallback</span><span class="o">()</span> <span class="o">{</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onSuccess</span><span class="o">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">NbObject</span><span class="o">&gt;</span> <span class="n">objects</span><span class="o">,</span> <span class="n">Num</span> <span class="n">count</span><span class="o">)</span> <span class="o">{</span>
        <span class="o">...</span><span class="na">後略</span><span class="o">...</span>

<span class="c1">// 新実装(全件数取得不要な場合)</span>
<span class="n">bucket</span><span class="o">.</span><span class="na">query</span><span class="o">(</span><span class="n">query</span><span class="o">,</span> <span class="k">new</span> <span class="n">NbListCallback</span><span class="o">&lt;</span><span class="n">NbObject</span><span class="o">&gt;()</span> <span class="o">{</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onSuccess</span><span class="o">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">NbObject</span><span class="o">&gt;</span> <span class="n">objects</span><span class="o">)</span> <span class="o">{</span>
        <span class="o">...</span><span class="na">後略</span><span class="o">...</span>

<span class="c1">// 新実装(全件数取得必要な場合)</span>
<span class="n">bucket</span><span class="o">.</span><span class="na">queryWithCount</span><span class="o">(</span><span class="n">query</span><span class="o">,</span> <span class="k">new</span> <span class="n">NbCountCallback</span><span class="o">&lt;</span><span class="n">List</span><span class="o">&lt;</span><span class="n">NbObject</span><span class="o">&gt;&gt;()</span> <span class="o">{</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onSuccess</span><span class="o">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">NbObject</span><span class="o">&gt;</span> <span class="n">objects</span><span class="o">,</span> <span class="kt">int</span> <span class="n">count</span><span class="o">)</span> <span class="o">{</span>
        <span class="o">...</span><span class="na">後略</span><span class="o">...</span>
</pre></div>
</div>
<p>また、NbQuery のソート順序関連メソッドとして setSortOrders, addSortOrder, getSortOrders が追加されました。
旧メソッド(setSortOrder, getSortOrder) も使用できますが、&#64;Deprecated 扱いとなります。</p>
</div>
<div class="section" id="id7">
<h3>13.3.7. クライアント証明書認証<a class="headerlink" href="#id7" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>クライアント証明書認証に対応しました。</p>
<p>NbService.setClinetCertificate を使用してクライアント証明書の設定が可能です。
対応するサーバとのhttps通信時に、ログインを行わなくともユーザ権限が付与された状態でアクセスできます。</p>
<p>詳細は  <a class="reference external" href="./user.html">ユーザ管理</a> を参照してください。</p>
</div>
</div>
<div class="section" id="ver-5-0-1-6-0-0">
<h2>13.4. ver 5.0.1 → 6.0.0 での変更点<a class="headerlink" href="#ver-5-0-1-6-0-0" title="このヘッドラインへのパーマリンク">¶</a></h2>
<div class="section" id="push">
<h3>13.4.1. Push<a class="headerlink" href="#push" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>FCM (Firebase Cloud Messaging) に対応しました。</p>
<p>旧 GCM (Google Cloud Messaging) も使用できますが、FCM に移行することを
推奨します。詳細は <a class="reference external" href="../push/index.html">Push 通知ガイド</a> の
&quot;Android Push (FCM)&quot; を参照してください。</p>
<p>なお、GCM を使用する場合は以下の点にご注意ください。</p>
<ul class="simple">
<li>NbGCMPushInstallationCallback は廃止となっています NbFcmPushInstallationCallback に変更してください。シグネチャも変更となっているので注意してください。</li>
<li>NbGCMPushInstallation クラスは NbFcmPushInstallation を継承するように変更されています。</li>
</ul>
</div>
</div>
<div class="section" id="ver-5-0-0-5-0-1">
<h2>13.5. ver 5.0.0 → 5.0.1 での変更点<a class="headerlink" href="#ver-5-0-0-5-0-1" title="このヘッドラインへのパーマリンク">¶</a></h2>
<div class="section" id="sse-push">
<h3>13.5.1. SSE Push<a class="headerlink" href="#sse-push" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>以下の不具合を修正しました。</p>
<ul class="simple">
<li>SSE Push の TCP 接続途中経路が切断した場合に、クライアント側で切断検知できない。</li>
<li>SSE Push のハートビート喪失を検出したあと、SSE Push の再接続が実行されない。</li>
</ul>
<p>これにともない、SSE Push クライアント側に無通信エラーを検知するための API を追加しました。具体的には以下２点です。</p>
<ul class="simple">
<li>NbSsePushReceiveClient: setHeartbeatInterval() API を追加</li>
<li>NbSsePushReceiveCallback: onHeartbeatLost() コールバックを追加</li>
</ul>
<div class="admonition attention">
<p class="first admonition-title">注意</p>
<p class="last">SSE Push クライアントの API が変更となったため、既存のアプリケーションは修正が必要となります。</p>
</div>
<p>詳細は、<a class="reference external" href="../push/index.html">Push通知ガイド</a>
の <a class="reference external" href="../push/sse/impl_java.html">SSE Push受信実装(Pure Java/Android編)</a> 、
および <a class="reference external" href="../../java-android_reference/index.html">Java / Android リファレンス</a> を参照ください。</p>
</div>
</div>
<div class="section" id="ver-4-0-0-5-0-0">
<h2>13.6. ver 4.0.0 → 5.0.0 での変更点<a class="headerlink" href="#ver-4-0-0-5-0-0" title="このヘッドラインへのパーマリンク">¶</a></h2>
<div class="section" id="id11">
<h3>13.6.1. ユーザ管理<a class="headerlink" href="#id11" title="このヘッドラインへのパーマリンク">¶</a></h3>
<ul class="simple">
<li>ユーザの所属グループ情報を取得する API を追加しました。</li>
<li>ユーザ検索時に skip/limit 条件を指定する API を追加しました。</li>
</ul>
</div>
</div>
<div class="section" id="ver-3-0-0-4-0-0">
<h2>13.7. ver 3.0.0 → 4.0.0 での変更点<a class="headerlink" href="#ver-3-0-0-4-0-0" title="このヘッドラインへのパーマリンク">¶</a></h2>
<div class="section" id="sqlcipher">
<h3>13.7.1. SQLCipher<a class="headerlink" href="#sqlcipher" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>オフライン機能のデータベース暗号化に使用する SQLCipher が SDK には含まれなくなりました。</p>
<p>オフライン機能を使用する際は、Maven Central から SQLCipher をダウンロードするようにするため、
アプリケーション側 build.gradle の dependency に以下の記述を追加する必要があります。
詳細は <a class="reference internal" href="setup.html#sdk-setup"><span class="std std-ref">SDKセットアップ手順</span></a> を参照してください。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">compile</span> <span class="s1">&#39;net.zetetic:android-database-sqlcipher:3.3.1-2&#39;</span>
</pre></div>
</div>
</div>
<div class="section" id="id12">
<h3>13.7.2. 依存ライブラリの更新<a class="headerlink" href="#id12" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>依存ライブラリの一部のバージョンが更新されています。
<a class="reference internal" href="setup.html#sdk-setup"><span class="std std-ref">SDKセットアップ手順</span></a> を参照して、build.gradle の更新を行ってください。</p>
</div>
<div class="section" id="id13">
<h3>13.7.3. SSE Push 機能追加<a class="headerlink" href="#id13" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>SSE Push 送受信機能が追加されました。
詳細は <a class="reference external" href="../push/index.html">Push通知ガイド</a> を参照ください。</p>
</div>
<div class="section" id="sde-push">
<h3>13.7.4. SDE Push 機能削除<a class="headerlink" href="#sde-push" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>SDE Push 機能削除が削除されました。ライブラリも削除されています。</p>
</div>
<div class="section" id="adt-plugin">
<h3>13.7.5. ADT Plugin サポート削除<a class="headerlink" href="#adt-plugin" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>ADT (Android Developer Tools) のサポート終了にともない、
ADT Plugin 向けのライブラリ類を削除しました。</p>
<p>Eclipse + ADT をお使いの場合は、Gradle + Android Studio への移行が必要です。</p>
</div>
</div>
<div class="section" id="ver-1-2-3-3-0-0">
<h2>13.8. ver 1.2.3 →3.0.0 での変更点<a class="headerlink" href="#ver-1-2-3-3-0-0" title="このヘッドラインへのパーマリンク">¶</a></h2>
<div class="section" id="id15">
<h3>13.8.1. バッチAPIの追加<a class="headerlink" href="#id15" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>オブジェクトストレージにバッチ API が追加されました。
詳細は、APIリファレンスの NbObjectBucket を参照ください。</p>
</div>
<div class="section" id="id16">
<h3>13.8.2. ユーザオプションフィールドの追加<a class="headerlink" href="#id16" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>ユーザに任意の情報をオプションとして設定できるようになりました。
詳細は、APIリファレンス NbUser クラスの setOptions(), getOptions()
メソッドを参照ください。</p>
</div>
<div class="section" id="sslv3">
<h3>13.8.3. SSLv3 無効化<a class="headerlink" href="#sslv3" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>POODLE脆弱性対策のため、SSLv3 接続を無効化しました。</p>
</div>
</div>
<div class="section" id="ver-1-2-2-1-2-3">
<h2>13.9. ver 1.2.2 → 1.2.3 での変更点<a class="headerlink" href="#ver-1-2-2-1-2-3" title="このヘッドラインへのパーマリンク">¶</a></h2>
<div class="section" id="id17">
<h3>13.9.1. オフライン機能の改善<a class="headerlink" href="#id17" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>オブジェクトバケットのバケットモードに、ローカルモードが追加されました。
ローカルモードは常にローカルキャッシュを読み書きするモードで、サーバとは同期しません。</p>
<p>また、大量のオブジェクトを同期する際、分割同期を行うことでメモリ使用量を削減しています。</p>
</div>
<div class="section" id="id18">
<h3>13.9.2. API強化<a class="headerlink" href="#id18" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>以下の API 強化が行われています。</p>
<blockquote>
<div><ul class="simple">
<li>ユーザ管理: ユーザ名に &quot;&#64;&quot; を使用可能</li>
<li>ユーザ管理: NbUser にオプションフィールドを追加 (任意の Key-Value 値を格納可能)</li>
<li>グループ管理: グループ保存時に楽観ロックを実施する</li>
<li>例外対応: API呼び出し時に引数不正の場合は IllegalArgumentException を throw する</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="pure-java">
<h3>13.9.3. マルチテナント対応 (Pure Java のみ)<a class="headerlink" href="#pure-java" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>マルチテナントに対応しました。複数の NbService を同時に使用して、
複数のサーバ・テナント・アプリに同時接続できます。</p>
<p>API 上は以下の変更が加わっています。</p>
<blockquote>
<div><ul>
<li><p class="first">NbService</p>
<blockquote>
<div><ul class="simple">
<li>enableMultiTenant() 追加</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">NbUser, NbGroup, NbObject</p>
<blockquote>
<div><ul class="simple">
<li>マルチテナント対応メソッド追加</li>
</ul>
</div></blockquote>
</li>
</ul>
</div></blockquote>
</div>
</div>
<div class="section" id="ver-1-2-1-1-2-2">
<h2>13.10. ver 1.2.1 → 1.2.2 での変更点<a class="headerlink" href="#ver-1-2-1-1-2-2" title="このヘッドラインへのパーマリンク">¶</a></h2>
<div class="section" id="id19">
<h3>13.10.1. オフライン機能の改善<a class="headerlink" href="#id19" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>オブジェクトストレージのオフライン機能が大幅に変更されています。</p>
<p>オブジェクトバケットに、バケットモード(NbBucketMode)が追加されました。
バケットモードには以下のモードがあります。</p>
<blockquote>
<div><ul class="simple">
<li>オンラインモード: 常にサーバと通信するモードです。</li>
<li>レプリカモード: 常にローカルキャッシュを読み書きするモードです。サーバとの通信は、同期時にのみ発生します。</li>
</ul>
</div></blockquote>
<p>API上は以下の変更が加わっています。</p>
<blockquote>
<div><ul>
<li><p class="first">キャッシュポリシーおよびネットワークモードの概念および関連 API を削除</p>
</li>
<li><p class="first">NbObjectBucketManager</p>
<blockquote>
<div><ul class="simple">
<li>getBucket(), deleteBucket() をオンライン / レプリカモード用の2つの API に分離</li>
<li>setSyncScope() / getSyncScope() 削除</li>
<li>registerSyncEventListener() / unregisterSyncEventListener() 削除</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">NbObjectBucket</p>
<blockquote>
<div><ul class="simple">
<li>setSyncScope() / getSyncScope() 追加</li>
<li>registerSyncEventListener() / unregisterSyncEventListener() 追加</li>
<li>getLastSyncTime() 追加</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">NbObject</p>
<blockquote>
<div><ul class="simple">
<li>コンストラクタの引数変更 (モード引数追加)</li>
<li>sync(), removeCache() 削除</li>
</ul>
</div></blockquote>
</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="id20">
<h3>13.10.2. オフラインバケットインデックス機能の追加<a class="headerlink" href="#id20" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>オフラインバケット(レプリカモード)の検索を高速化するため、
オブジェクトに対しインデックスを設定できる API を追加しました。</p>
<p>詳細は、NbObjectBucket.setIndexToLocal() APIを参照してください。</p>
</div>
<div class="section" id="id21">
<h3>13.10.3. インデックス・シャードキー関連<a class="headerlink" href="#id21" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>インデックスキー、シャードキー関連の API は削除されました。</p>
</div>
<div class="section" id="id22">
<h3>13.10.4. ファイルオフライン機能<a class="headerlink" href="#id22" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>ファイルオフライン関連の API は削除されました。</p>
</div>
</div>
<div class="section" id="ver-1-2-0-1-2-1">
<h2>13.11. ver 1.2.0 → 1.2.1 での変更点<a class="headerlink" href="#ver-1-2-0-1-2-1" title="このヘッドラインへのパーマリンク">¶</a></h2>
<div class="section" id="jar">
<h3>13.11.1. ライブラリJARの変更<a class="headerlink" href="#jar" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>Android ネイティブ開発時には、NebulaClientCore-x.x.x.jar は不要になりました。
NebulaClientCore-x.x.x.jar 相当の機能はすべて NebulaClientAndroid-x.x.x.jar に含まれます。</p>
</div>
<div class="section" id="id23">
<h3>13.11.2. ユーザ/グループAPIの変更<a class="headerlink" href="#id23" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>NbUserInfo, NbGroupInfo クラスは廃止となりました。
コールバック関数では、代わりに直接 NbUser, NbGroup クラスが渡されるように
変更しています。</p>
</div>
</div>
<div class="section" id="ver-1-1-0-1-2-0-api">
<h2>13.12. ver 1.1.0 → 1.2.0 での API 変更点<a class="headerlink" href="#ver-1-1-0-1-2-0-api" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>1.2.0 では、パッケージ名・クラス名・定数名を大幅に見直ししています。</p>
<div class="section" id="id24">
<h3>13.12.1. パッケージの変更<a class="headerlink" href="#id24" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>トップレベルパッケージを、com.nec.android.baas から com.nec.baas に
変更しました(全クラスに影響あり)。</p>
<p>また、機能別にサブパッケージを以下の通り分割しています。</p>
<blockquote>
<div><ul class="simple">
<li>core: コア機能</li>
<li>user: ユーザ・グループ管理</li>
<li>object: オブジェクトストレージ</li>
<li>file: ファイルストレージ</li>
<li>json: JSONパーサ・ジェネレータ</li>
<li>push: Push</li>
<li>generic: Pure Java 実装</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="id25">
<h3>13.12.2. クラス名の変更<a class="headerlink" href="#id25" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>すべてのクラス名の先頭に &quot;Nb&quot; プレフィクスを追加しました。</p>
<p>ただし、従来 &quot;Nebula&quot; プレフィクスがついていたクラスは &quot;Nebula&quot;
を削除して &quot;Nb&quot; に変更しています (例: NebulaObject → NbObject)。</p>
<p>上記ルール以外の変更としては、以下の変更を行っています。</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">変更前</th>
<th class="head">変更後</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>BucketInfoCallback</td>
<td>NbBucketCallback</td>
</tr>
<tr class="row-odd"><td>FileResolveConflict</td>
<td>NbFileConflictResolver</td>
</tr>
<tr class="row-even"><td>FileResolveConflictListener</td>
<td>NbFileConflictResolverListener</td>
</tr>
<tr class="row-odd"><td>FileResolveConflictListener.SyncErrorCode</td>
<td>NbFileConflistResolverListener.SyncError</td>
</tr>
<tr class="row-even"><td>NebulaDownloadCallback</td>
<td>NbFileDownloadCallback</td>
</tr>
<tr class="row-odd"><td>IndexInfoCallback</td>
<td>NbIndexCallback</td>
</tr>
<tr class="row-even"><td>ResolveConflict</td>
<td>NbObjectConflictResolver</td>
</tr>
<tr class="row-odd"><td>SyncEventListener</td>
<td>NbObjectSYncEventListener</td>
</tr>
<tr class="row-even"><td>GroupInfo</td>
<td>NbGroupEntity</td>
</tr>
<tr class="row-odd"><td>GroupInfoCllback</td>
<td>NbGroupEntityCallback</td>
</tr>
<tr class="row-even"><td>UserInfo</td>
<td>NbUserEntity</td>
</tr>
<tr class="row-odd"><td>UserInfoCallback</td>
<td>NbUserEntityCallback</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id26">
<h3>13.12.3. 定数名変更<a class="headerlink" href="#id26" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>NbClause (旧 Clause) の定数を以下のとおり変更しました。</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">変更前</th>
<th class="head">変更後</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>CASE_INSENSITIVITY</td>
<td>IGNORE_CASE</td>
</tr>
<tr class="row-odd"><td>CASE_MULTILINE</td>
<td>MULTILINE</td>
</tr>
<tr class="row-even"><td>CASE_EXTENDED</td>
<td>EXTENDED</td>
</tr>
<tr class="row-odd"><td>CASE_DOT_MULTILINE</td>
<td>DOT_MATCH_NEWLINE</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="int-enum">
<h3>13.12.4. 型変更 (int → enum)<a class="headerlink" href="#int-enum" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>NbObjectSyncEventListener (旧 SyncEventListener) に定義されていたエラーコード(int型)
を SyncError (enum) に変更しました。さらに、以下の名称変更を行いました。</p>
<blockquote>
<div><ul class="simple">
<li>ID_OVERLAP_ERROR → ID_CONFLICTED</li>
<li>PUSH_ERROR_RESYNCING → SYNC_RETRYING</li>
</ul>
</div></blockquote>
<p>NbSetting クラス(旧NebulaSetting) に以下の変更を行いました。</p>
<blockquote>
<div><ul class="simple">
<li>getCachePolicy の返り値の型を int → NbCachePolicy(enum) に変更</li>
<li>setOperationMode の型を int → NbOperationMode(enum) に変更</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="id27">
<h3>13.12.5. その他<a class="headerlink" href="#id27" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>NbObjectSycnResoltCallback.onFailure() に NbErrorInfo 引数を追加しました。</p>
</div>
</div>
<div class="section" id="ver-1-0-0-1-1-0-api">
<h2>13.13. ver 1.0.0 → 1.1.0 での API 変更点<a class="headerlink" href="#ver-1-0-0-1-1-0-api" title="このヘッドラインへのパーマリンク">¶</a></h2>
<div class="section" id="push-api">
<h3>13.13.1. Push 関連 API の追加<a class="headerlink" href="#push-api" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>Push 関連 API が追加されました。</p>
</div>
<div class="section" id="onfailure">
<h3>13.13.2. onFailure メソッド引数変更<a class="headerlink" href="#onfailure" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>BaseCallback およびこれを継承する全インタフェースの
onFailure() メソッドに第二引数が追加されました。</p>
<p>第二引数の型は NbErrorInfo であり、エラー理由が格納
されます。</p>
</div>
<div class="section" id="networkmode-cachepolicy-syncstate">
<h3>13.13.3. NetworkMode, CachePolicy, SyncState 型の導入<a class="headerlink" href="#networkmode-cachepolicy-syncstate" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>ネットワークモード、キャッシュポリシー、同期状態を
表す列挙型として NetworkMode, CachePolicy, SyncState
が導入されました。</p>
<p>これにともない、以下のメソッドの返り値が int から
上記列挙型に変更されました。</p>
<blockquote>
<div><ul class="simple">
<li>NebulaService.getNetworkMode()</li>
<li>NebulaService.getCachePolicy()</li>
<li>NebulaObject.getSyncState()</li>
<li>FileMetadata.getFileSyncState()</li>
<li>ObjectBucket.getResolveConflictPolicy()</li>
<li>FileBucket.getResolveConflictPolicy()</li>
</ul>
</div></blockquote>
<p>また、以下メソッドは Deprecated となります。</p>
<blockquote>
<div><ul class="simple">
<li>NebulaService.setNetworkMode(int)</li>
<li>NebulaService.setCachePolicy(int)</li>
<li>ObjectBucket.setResolveConflictPolicy(int)</li>
<li>FileBucket.setResolveConflictPolicy(int)</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="android">
<h3>13.13.4. コールバックスレッドの動作変更(Android実装のみ)<a class="headerlink" href="#android" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>従来、Android 実装ではコールバック呼び出し時の
スレッドは以下のようになっていました。</p>
<blockquote>
<div><ul class="simple">
<li>ネットワーク通信を伴うAPI(同期除く) : UIスレッド</li>
<li>オフラインAPI呼び出し : 別スレッド</li>
<li>同期コールバック : 別スレッド</li>
</ul>
</div></blockquote>
<p>ver 1.1 では、いずれの場合も UI スレッドでコール
バックされるように変更されています。</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="restrictions.html" class="btn btn-neutral float-right" title="14. 制限事項" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="api_gateway.html" class="btn btn-neutral" title="12. API Gateway" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2013-2019, NEC Corporation

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="https://www.googletagmanager.com/gtag/js?id=UA-116465316-2"></script>
        <script type="text/javascript" src="_static/analytics.js"></script>
        <script type="text/javascript" src="_static/translations.js"></script>
    

  

  <script type="text/javascript" src="_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>