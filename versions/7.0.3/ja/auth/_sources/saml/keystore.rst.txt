キーストアの登録
================

SAML 認証を使用する前に、キーストアファイルの作成とシステムへの登録を行っておく必要があります。

.. attention::

  登録にはシステム管理者権限が必要です。


キーストアファイルの作成
------------------------

キーストアファイルを作成するには、JDK に付属されている keytool を使用します。

コマンドラインから以下のコマンドを入力してキーストアファイル 'samlKeystore.jks'
を作成してください。

.. code-block:: bash

    keytool -genkeypair -alias [alias名] -keyalg rsa -validity [有効日数] -keystore samlKeystore.jks

キーストアの有効期限が切れると認証がすべて失敗してしまいますので、有効日数は十分長い日数(30年など)に設定してください。
有効期限が切れた場合は、キーストアファイルの再設定と、SPメタデータのエクスポート・IdPへの再登録が必要になります。

.. attention::

   キーストアパスワードと鍵パスワードは同一にしてください。

キーストアファイルの登録
-------------------------

デベロッパーコンソールにシステム管理者権限でログインしてください。

画面上部の「管理」より「SAML KeyStore」を選択するとキーストアの管理画面に移行します。
「編集ボタン」を押して作成したキーストアファイルをアップロードしてください。
この際、キーストアファイル作成時に指定したキーストアパスワードと alias名が必要になります。


