=======================
システム設定
=======================

.. include:: ../../common/linkdef.rst

「システム設定」はシステム全体に関わる設定を行うことができます。
システム設定はシステム管理者のみが行うことができます。

システム設定は、画面右上の「管理」の「システム設定」にあります。

設定可能な項目は以下の通りです。

一般設定
--------

* APIサーバベースURI

  - APIサーバの外部向け URIです。
  - 設定例 ⇒ https://api.example.com/api
  - 本 URI はユーザのパスワードリセット時などで送信されるメールに記載されるベース URI として使用されます。
    通常、Internet からアクセス可能な URI としてください。

* APIサーバ内部向けベースURI

  - APIサーバの内部向け URIです。
  - 設定例 ⇒ http://10.0.0.5/api
  - 本 URI は、Cluod Functions サーバから API 呼び出しを行う際に使用されます。
    したがって、Cloud Functions サーバから到達可能な URL とする必要があります。

* SSE Push サーバ公開 URI:

  - SSE Push サーバの外部向け URIです。
  - 設定例 ⇒ https://api.example.com/ssepush/events
  - クライアントから見た SSE Push サーバの URI (末尾の /events まで含む)を指定してください。
  - 詳細は `Push通知ガイド <../../push/index.html>`_ の「SSE Push サーバセットアップ」の節を参照してください。

* システムキー

  - システムキーはシステムログを REST API で取得する際に使用します。
  - 一種のパスフレーズですので、容易に類推できない文字列を設定してください。
  - 設定は省略可能です。省略した場合は、システムログを REST API で取得する機能は無効化されます。

データベース設定
-----------------

* MongoDBデフォルトクエリタイムアウト

  - MongoDB に対するオブジェクトストレージのクエリタイムアウト時間を指定します。
    本タイムアウト時間は MongoDB サーバ側でのクエリ実行タイムアウトです。
  - 0以下の値を指定した場合は、タイムアウトは設定されません。
  - REST API でタイムアウト時間を指定した場合は、REST API パラメータのほうが優先されます。

デベロッパーコンソール設定
---------------------------

* コンソールサーバベースURI

  - コンソールサーバの外部向け URI です。
  - 設定例 ⇒ https://console.example.com/console
  - 本 URI はデベロッパーのパスワードリセット時に送信されるメールに記載されるベース URI として使用されます。
    通常、Internet からアクセス可能な URI としてください。

* コンソールセルフサインアップ許可

  - デベロッパーコンソールのセルフサインアップ機能の有効設定を行います。
  - デフォルトは「禁止」です(セキュリティ上、禁止で運用することを推奨します)

* デベロッパーコンソール ヘルプ URL

  - 本 URL は、デベロッパーコンソール画面右上の「ヘルプ」のリンク先となります。
  - 「デベロッパーコンソール利用ガイド」の URL などを指定してください。
  - 指定しなくても動作上問題はありませんが、ヘルプは使用できません。

メール設定
----------

メール送信に関する設定を行います。

* SMTPサーバ: SMTPサーバホスト名
* SMTPサーバポート番号: SMTPサーバのポート番号。通常は 25 を指定してください。
* SMTP認証ユーザ名: 認証不要な場合は空欄。
* SMTP認証パスワード: 認証不要な場合は空欄。
* メール送信Fromメールアドレス: メール送信時の From に指定するメールアドレスを指定します。

なお、BaaS サーバは、以下のようなケースでメールを送信します。

* REST API で、パスワードリセット用メールを送信する。
* デベロッパコンソールから、パスワードリセットメールを送信する。
* デベロッパコンソールから、デベロッパの招待メールを送信する。

プロキシサーバ設定
--------------------

プロキシサーバの設定を行います。

ここで設定したプロキシサーバは、S3互換外部ファイルストレージアクセス時やOpenID Connect連携時に使用されます。

* プロキシサーバホスト: プロキシサーバのホスト名を指定します。
* プロキシサーバポート番号: プロキシサーバのポート番号を指定します。
* プロキシ例外リスト

  - プロキシサーバを経由しないホストを指定します。
  - 設定例 ⇒ localhost;127.0.0.1;*test.com
  - ホストの区切りには改行も使用可能です。

.. _system_config_client_cert:

クライアント証明書設定
-----------------------

クライアント証明書認証使用時に、リクエスト送信元のリバースプロキシを検証するための、サーバーキーを設定します。
リバースプロキシに設定した値（X-SSL-Validate-Token ヘッダの値）と同一のキーを設定します。

一種のパスフレーズですので、容易に類推できない文字列を設定してください。

詳細は `HAProxyの設定手順 <../../auth/clientcert/haproxy.html>`_ を参照してください。

ファイルストレージ設定
-----------------------

ファイルストレージに関する設定を行います。

* ファイルの最大サイズ(メガバイト)

  - ファイルストレージにアップロードできるファイルの最大サイズを指定します（単位：MByte）。
  - デフォルトは 100MB です。
  - AWS S3 にファイルデータを格納する場合、本設定を適用せず、AWS S3 の上限まで格納可能です。
